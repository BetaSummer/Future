{"version":3,"sources":["../../../javascript/text.js"],"names":["container","camera","scene","renderer","group","textMesh","textGeo","material","text","height","size","hover","curveSegments","bevelThickness","bevelSize","bevelSegments","bevelEnabled","fontMap","weightMap","fontIndex","font","fontName","fontWeight","mouseX","mouseY","windowHalfX","window","innerWidth","windowHalfY","innerHeight","init","animate","document","createElement","body","appendChild","info","style","position","top","width","color","textShadow","fontSize","textAlign","innerHTML","THREE","PerspectiveCamera","set","Scene","getTime","setInterval","timeChange","MultiMaterial","MeshBasicMaterial","Math","random","overdraw","Group","add","loadFont","WebGLRenderer","setClearColor","setSize","domElement","addEventListener","onDocumentMouseMove","onWindowResize","target","now","Date","day","toString","split","hour","getHours","minute","getMinutes","second","getSeconds","t","console","log","aspect","updateProjectionMatrix","event","clientX","clientY","loader","FontLoader","load","response","refreshText","createText","TextGeometry","extrudeMaterial","computeBoundingBox","computeVertexNormals","triangleAreaHeuristics","i","faces","length","face","materialIndex","j","vertexNormals","z","normalize","va","vertices","a","vb","b","vc","c","s","GeometryUtils","triangleArea","copy","normal","centerOffset","boundingBox","max","x","min","Mesh","y","rotation","PI","remove","render","lookAt","clear","requestAnimationFrame"],"mappings":"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","file":"text.js","sourcesContent":["/* global THREE Detector */\n/* eslint-env browser */\n/* eslint no-console: 0 */\n/* eslint wrap-iife: 0 */\n\nlet container;\nlet camera, scene, renderer;\nlet group, textMesh, textGeo, material;\n\nlet text = \"66:66:66\";\nlet height = 10;\nlet size = 80;\nlet hover = 30;\nlet curveSegments = 4;\nlet bevelThickness = 2;\nlet bevelSize = 1.5;\nlet bevelSegments = 3;\nlet bevelEnabled = true;\nlet fontMap = {\n  \"helvetiker\": 0,\n  \"optimer\": 1,\n  \"gentilis\": 2,\n  \"droid/droid_sans\": 3,\n  \"droid/droid_serif\": 4\n};\nlet weightMap = {\n  \"regular\": 0,\n  \"bold\": 1\n};\nlet fontIndex = 1;\nlet font;\nlet fontName;\nlet fontWeight;\n\nlet mouseX = 0;\nlet mouseY = 0;\n\nlet windowHalfX = window.innerWidth / 2;\nlet windowHalfY = window.innerHeight / 2;\n\ninit();\nanimate();\n\nfunction init() {\n  container = document.createElement('div');\n  document.body.appendChild(container);\n\n  // title 信息处理\n  const info = document.createElement('div');\n  info.style.position = 'absolute';\n  info.style.top = '10px';\n  info.style.width = '100%';\n  info.style.color = '#383838';\n  info.style.textShadow = '0 0 5px #383838';\n  info.style.fontSize = '20px';\n  info.style.textAlign = 'center';\n  info.innerHTML = 'Welcome ! β-house recruitment coming soon.';\n  container.appendChild(info);\n\n  // camera\n  camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 800);\n  camera.position.set(0, 250, 500);\n\n  // scene\n  scene = new THREE.Scene();\n\n  // get text\n  text = getTime();\n  setInterval(timeChange, 1000);\n\n  material = new THREE.MultiMaterial([new THREE.MeshBasicMaterial({ color: Math.random() * 0xffffff, overdraw: 0.5 }), new THREE.MeshBasicMaterial({ color: Math.random() * 0xffffff - 0x100000, overdraw: 0.5 })]);\n\n  group = new THREE.Group();\n\n  scene.add(group);\n\n  fontName = 'helvetiker';\n  fontWeight = 'bold';\n\n  loadFont();\n\n  renderer = new THREE.WebGLRenderer();\n  renderer.setClearColor(0xf0f0f0);\n  // renderer.setPixelRatio( window.devicePixelRatio );\n  renderer.setSize(window.innerWidth, window.innerHeight);\n  container.appendChild(renderer.domElement);\n\n  window.addEventListener('mousemove', onDocumentMouseMove, false);\n  window.addEventListener('resize', onWindowResize, false);\n}\n\n// get time\nfunction getTime() {\n  const target = [3, 28, 18, 0];\n  const now = new Date();\n\n  const day = target[1] - now.toString().split(' ')[2];\n  let hour = day * 24 + (target[2] - now.getHours());\n  let minute = target[3] - now.getMinutes();\n  if (minute <= 0) {\n    hour -= 1;\n    minute += 59;\n  }\n  const second = 60 - now.getSeconds();\n  return `${hour}:${minute}:${second}`;\n}\nfunction timeChange() {\n  const t = text.split(':');\n  if (t[2] !== '0') {\n    t[2] -= 1;\n  } else if (t[1] !== '0') {\n    t[2] = '59';\n    if (t[1] !== '0') {\n      t[1] -= 1;\n    } else {\n      t[1] = '59';\n      if (t[0] !== '0') {\n        t[0] -= 1;\n      }\n    }\n  }\n  console.log('time chaged');\n  console.log(text);\n  text = `${t[0]}:${t[1]}:${t[2]}`;\n}\n\n// event handle functions\nfunction onWindowResize() {\n  windowHalfX = window.innerWidth / 2;\n  windowHalfY = window.innerHeight / 2;\n  camera.aspect = window.innerWidth / window.innerHeight;\n  camera.updateProjectionMatrix();\n  renderer.setSize(window.innerWidth, window.innerHeight);\n}\nfunction onDocumentMouseMove(event) {\n  mouseX = (event.clientX - windowHalfX) / 5;\n  mouseY = (event.clientY - windowHalfY) / 5;\n}\n\n// font handle function\nfunction loadFont() {\n  const loader = new THREE.FontLoader();\n  loader.load('fonts/' + fontName + '_' + fontWeight + '.typeface.json', function (response) {\n    font = response;\n    refreshText();\n  });\n}\nfunction createText() {\n  textGeo = new THREE.TextGeometry(text, {\n    font: font,\n    size: size,\n    height: height,\n    curveSegments: curveSegments,\n    bevelThickness: bevelThickness,\n    bevelSize: bevelSize,\n    bevelEnabled: bevelEnabled,\n    material: 0,\n    extrudeMaterial: 1\n  });\n  textGeo.computeBoundingBox();\n  textGeo.computeVertexNormals();\n  if (!bevelEnabled) {\n    const triangleAreaHeuristics = 0.1 * (height * size);\n    for (let i = 0; i < textGeo.faces.length; i++) {\n      const face = textGeo.faces[i];\n      if (face.materialIndex === 1) {\n        for (let j = 0; j < face.vertexNormals.length; j++) {\n          face.vertexNormals[j].z = 0;\n          face.vertexNormals[j].normalize();\n        }\n        const va = textGeo.vertices[face.a];\n        const vb = textGeo.vertices[face.b];\n        const vc = textGeo.vertices[face.c];\n        const s = THREE.GeometryUtils.triangleArea(va, vb, vc);\n        if (s > triangleAreaHeuristics) {\n          for (let j = 0; j < face.vertexNormals.length; j++) {\n            face.vertexNormals[j].copy(face.normal);\n          }\n        }\n      }\n    }\n  }\n  const centerOffset = -0.5 * (textGeo.boundingBox.max.x - textGeo.boundingBox.min.x);\n  textMesh = new THREE.Mesh(textGeo, material);\n  textMesh.position.x = centerOffset;\n  textMesh.position.y = hover - 100;\n  textMesh.position.z = 0;\n  textMesh.rotation.x = 0;\n  textMesh.rotation.y = Math.PI * 2;\n  group.add(textMesh);\n}\nfunction refreshText() {\n  group.remove(textMesh);\n  if (!text) return;\n  createText();\n}\n// animate\nfunction render() {\n  camera.position.x += (mouseX - camera.position.x) * 0.15;\n  camera.position.y += (-mouseY - camera.position.y) * 0.15;\n  camera.lookAt(scene.position);\n\n  renderer.clear();\n  renderer.render(scene, camera);\n}\nfunction animate() {\n  requestAnimationFrame(animate);\n  refreshText();\n  render();\n}\n//# sourceMappingURL=text.js.map"]}